<!doctype html><html lang=en>
<head>
<title>Tetris, in TypeScript :: MarÃ­n's - Blog</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1">
<meta name=description content="With the intention of getting more familiarized with TypeScript, I decided to start a new project. It&amp;rsquo;s been many years since the last time I made a game from scrath so it seemed fitting to give that a go. I chose Tetris because it&amp;rsquo;s a well known game, with a defined set of problems and functionality. All I had to worry about was to code their solutions.
The TypeScript Lesson I did get more familiar with TypeScript, some of its strengths, caveats and tooling.">
<meta name=keywords content="TypeScript,Tetris">
<meta name=robots content="noodp">
<link rel=canonical href=https://marinhero.com/posts/typescript-tetris/>
<link rel=stylesheet href=https://marinhero.com/assets/style.css>
<link rel=stylesheet href=https://marinhero.com/assets/blue.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=https://marinhero.com/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=https://marinhero.com/img/favicon/blue.png>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Tetris, in TypeScript :: MarÃ­n's - Blog â€” ">
<meta name=twitter:description content="With the intention of getting more familiarized with TypeScript, I decided to start a new project. It&amp;rsquo;s been many years since the last time I made a game from scrath so it seemed fitting to give that a go. I chose Tetris because it&amp;rsquo;s a well known game, with a defined set of problems and functionality. All I had to worry about was to code their solutions.
The TypeScript Lesson I did get more familiar with TypeScript, some of its strengths, caveats and tooling.">
<meta name=twitter:site content="https://marinhero.com/">
<meta name=twitter:creator content="MarÃ­n">
<meta name=twitter:image content>
<meta property="og:locale" content="en">
<meta property="og:type" content="article">
<meta property="og:title" content="Tetris, in TypeScript :: MarÃ­n's - Blog â€” ">
<meta property="og:description" content="With the intention of getting more familiarized with TypeScript, I decided to start a new project. It&amp;rsquo;s been many years since the last time I made a game from scrath so it seemed fitting to give that a go. I chose Tetris because it&amp;rsquo;s a well known game, with a defined set of problems and functionality. All I had to worry about was to code their solutions.
The TypeScript Lesson I did get more familiar with TypeScript, some of its strengths, caveats and tooling.">
<meta property="og:url" content="https://marinhero.com/posts/typescript-tetris/">
<meta property="og:site_name" content="Tetris, in TypeScript">
<meta property="og:image" content>
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">
<meta property="article:published_time" content="2021-11-27 00:00:00 +0000 UTC">
<link rel=stylesheet href=https://marinhero.com/marin.css>
</head>
<body>
<div class="container center headings--one-size">
<header class=header>
<div class=header__inner>
<div class=header__logo>
<a href=/>
<div class=logo>
MarÃ­n Alcaraz
</div>
</a>
</div>
<div class=menu-trigger>menu</div>
</div>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/pages/marin>About</a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/pages/marin>About</a></li>
</ul>
</nav>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>
<a href=https://marinhero.com/posts/typescript-tetris/>Tetris, in TypeScript</a></h1>
<div class=post-meta>
<span class=post-date>
2021-11-27
</span>
<span class=post-author>::
MarÃ­n
</span>
</div>
<span class=post-tags>
#<a href=https://marinhero.com/tags/typescript/>TypeScript</a>&nbsp;
#<a href=https://marinhero.com/tags/gaming/>Gaming</a>&nbsp;
#<a href=https://marinhero.com/tags/web/>Web</a>&nbsp;
</span>
<div class=post-content><div>
<p>With the intention of getting more familiarized with TypeScript, I decided to start a new project.
It&rsquo;s been many years since the last time I made a game from scrath so it seemed fitting to give that a go.
I chose Tetris because it&rsquo;s a well known game, with a defined set of problems and functionality. All I had to worry about was to code their solutions.</p>
<h1 id=the-typescript-lesson>The TypeScript Lesson<a href=#the-typescript-lesson class=hanchor arialabel=Anchor>&#8983;</a> </h1>
<p>I did get more familiar with TypeScript, some of its strengths, caveats and tooling. Still, it would be hard (or overengineered) to cover all of the language features in a project. One important feature I left out is <a href=https://www.typescriptlang.org/docs/handbook/2/generics.html>generics</a>, perhaps I need to start working on <a href=https://en.wikipedia.org/wiki/Space_Invaders>Space Invaders</a> now so I can give it a try?</p>
<h1 id=implementation-details>Implementation Details<a href=#implementation-details class=hanchor arialabel=Anchor>&#8983;</a> </h1>
<p>I tried to keep it as lean as possible, therefore this is the tech I used:</p>
<ul>
<li>TypeScript ðŸª›</li>
<li>HTML Canvas and CSS for drawing and coloring ðŸŽ¨</li>
<li>Webpack for bundling everything ðŸ“¦</li>
</ul>
<h1 id=favorite-part>Favorite part<a href=#favorite-part class=hanchor arialabel=Anchor>&#8983;</a> </h1>
<p>The most fun part of the project was to write the function to create the possible rotations for each piece. I could have used a hard-coded two dimensional array with all of them in there but where&rsquo;s the fun in that?i Another downside of that approach is that I would have to limit the shapes of Tetris pieces I could use. Thanks to this function, I can create my custom shaped Tetris pieces! Anyway, <a href=https://github.com/marinhero/tsetris/blob/master/src/index.ts#L138>here&rsquo;s</a> the function:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript> <span style=color:#a6e22e>generateRotations</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>[][][] {
    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rots</span>: <span style=color:#66d9ef>Cell</span>[][][] <span style=color:#f92672>=</span> []
    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>nextBase</span>: <span style=color:#66d9ef>Cell</span>[][]

    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rotationCounter</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>rotationCounter</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>rotationCounter</span><span style=color:#f92672>++</span>) {
      <span style=color:#a6e22e>rots</span>[<span style=color:#a6e22e>rotationCounter</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>BlankPiece</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rows</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>columns</span>).<span style=color:#a6e22e>shape</span>
      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>destY</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>columns</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>columns</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>destX</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rows</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
          <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>nextBase</span>) {
            <span style=color:#a6e22e>rots</span>[<span style=color:#a6e22e>rotationCounter</span>][<span style=color:#a6e22e>destY</span>][<span style=color:#a6e22e>destX</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>shape</span>[<span style=color:#a6e22e>j</span>][<span style=color:#a6e22e>i</span>]
          } <span style=color:#66d9ef>else</span> {
            <span style=color:#a6e22e>rots</span>[<span style=color:#a6e22e>rotationCounter</span>][<span style=color:#a6e22e>destY</span>][<span style=color:#a6e22e>destX</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>nextBase</span>[<span style=color:#a6e22e>j</span>][<span style=color:#a6e22e>i</span>]
          }
          <span style=color:#a6e22e>destX</span><span style=color:#f92672>++</span>
        }
        <span style=color:#a6e22e>destY</span><span style=color:#f92672>--</span>
      }
      <span style=color:#a6e22e>nextBase</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>rots</span>[<span style=color:#a6e22e>rotationCounter</span>]
    }
    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>rots</span>
  }
</code></pre></div><p>I enjoyed working on this function because I had to keep track of how the Tetris piece was moving on every iteration at the cell level. It also forced me to initialize the <code>rots</code> array with a <code>BlankPiece</code>. This is an object that <code>extends Piece</code>. Initializations of the same type aren&rsquo;t required in JavaScript but they are in TypeScript. It was a nice reminder that I had to think about the type system once again.</p>
<h1 id=demo>Demo<a href=#demo class=hanchor arialabel=Anchor>&#8983;</a> </h1>
<p>Game available <a href=https://marinhero.com/tsetris/>here</a> (limited mobile support because that was out of the scope ðŸ˜†)</p>
<p><img src=https://github.com/marinhero/tsetris/raw/master/dist/demo.gif alt=Tetris></p>
</div></div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button next">
<a href=https://marinhero.com/posts/bash-history/>
<span class=button__text>Never Lose Another Bash Command Ever Again!</span>
<span class=button__icon>â†’</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class=copyright>
<span><script async defer src="https://www.recurse-scout.com/loader.js?t=07b8b390c492482130bcc37bffdd507b"></script></span>
</div>
</div>
</div>
</footer>
<script src=https://marinhero.com/assets/main.js></script>
<script src=https://marinhero.com/assets/prism.js></script>
</div>
</body>
</html>